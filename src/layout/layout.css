/* ============================================
   LAYOUT.CSS — Mission Secure (commented)
   ============================================ */

/* --------------------------------------------
   1) THEME TOKENS (Dark default)
   -------------------------------------------- */
:root{
  /* Layout */
  --topbar-h:56px;
  --sidebar-w:280px;

  /* Dark palette (defaults) */
  --bg:#0b1020;
  --surface:#0f172a;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --border:rgba(255,255,255,.08);
  --brand:#60a5fa;
  --brand-2:#7dd3fc;
  --ring:rgba(96,165,250,.45);
  --radius:12px;

  /* Spacing scale */
  --space-1:6px;
  --space-2:10px;
  --space-3:16px;
  --space-4:22px;
  --space-5:32px;

  /* Derived / bridge tokens */
  --panel: color-mix(in oklab, white 6%, transparent); /* glassy card on dark */
  --border-color: var(--border);
  --text-color: var(--text);

  /* Accents (sidebar/nav) */
  --primary:#7c5cff;
  --primary-2:#6a8dff;
  --accent-bg: color-mix(in oklab, var(--primary) 15%, transparent);
  --accent-border: color-mix(in oklab, var(--primary) 30%, transparent);
  --accent-text: var(--primary-2);

  /* Component themes */
  --topbar-bg: linear-gradient(180deg,#0b1020,#0a0f1d);
  --input-bg: rgba(255,255,255,.05);
  --btn-panel: rgba(255,255,255,.04);
  --btn-panel-hover: rgba(255,255,255,.08);
  --btn-primary-bg: linear-gradient(180deg,#223153,#1a2745);
  --btn-primary-bg-hover: linear-gradient(180deg,#273960,#1d2d51);
  --btn-primary-border: rgba(96,165,250,.35);
  --btn-primary-border-hover: rgba(125,211,252,.45);

  /* Purple glow tokens */
  --glow-main: rgba(124, 92, 255, .55);
  --glow-soft: rgba(124, 92, 255, .30);

  /* Backdrop for sidebar (used in Sidebar.css too) */
  --backdrop: rgba(0,0,0,.45);
}

/* --------------------------------------------
   2) THEME OVERRIDES — Light mode
   -------------------------------------------- */
:root[data-theme="light"]{
  --bg:#f6f7fb;
  --surface:#ffffff;
  --text:#17181c;
  --muted:#4b4f58;
  --border:#0000001a;

  --panel:#ffffff;
  --border-color: var(--border);
  --text-color: var(--text);

  --primary:#7c5cff;
  --primary-2:#6a8dff;
  --accent-bg: color-mix(in oklab, var(--primary) 10%, white 85%);
  --accent-border: color-mix(in oklab, var(--primary) 20%, white 75%);
  --accent-text: var(--primary);

  --topbar-bg: linear-gradient(180deg,#eef2ff,#e7ecff);
  --input-bg:#ffffff;
  --btn-panel:#ffffff;
  --btn-panel-hover:#f3f6ff;
  --btn-primary-bg: linear-gradient(180deg,#7c5cff,#6a8dff);
  --btn-primary-bg-hover: linear-gradient(180deg,#866bff,#7796ff);
  --btn-primary-border: rgba(124,92,255,.35);
  --btn-primary-border-hover: rgba(124,92,255,.5);

  --glow-main: rgba(124, 92, 255, .45);
  --glow-soft: rgba(124, 92, 255, .25);
}

/* --------------------------------------------
   3) GLOBAL BASE / RESET
   -------------------------------------------- */
*{ box-sizing:border-box }
html,body,#root{ height:100% }
body{
  margin:0;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background: var(--bg);
  color: var(--text-color);
}
.app-shell{ min-height:100% }

/* --------------------------------------------
   3.5) APP-WIDE BACKGROUND GLOW (animated, bold)
   -------------------------------------------- */
.app-shell{
  min-height:100%;
  position: relative;                 /* stacking context for glow */
  --glow-speed: 18s;                  /* drift speed */
  --glow-pulse: 6s;                   /* pulse speed */
}

.app-shell::before{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;                         /* behind UI */

  /* Two glow layers; we’ll animate both size and position */
  background:
    radial-gradient(60% 60% at center,
      color-mix(in oklab, var(--brand) 26%, transparent) 0%,
      transparent 70%) no-repeat,
    radial-gradient(70% 70% at center,
      color-mix(in oklab, var(--brand-2) 26%, transparent) 0%,
      transparent 70%) no-repeat;

  /* Starting size/position */
  background-size: 42vw 42vw, 48vw 48vw;
  background-position: 18% 12%, 80% 88%;

  opacity: .95;
  will-change: background-position, background-size, opacity, filter;
  animation:
    glow-drift var(--glow-speed) ease-in-out infinite alternate,
    glow-size  calc(var(--glow-speed) * 99) ease-in-out infinite alternate,
    glow-pulse var(--glow-pulse) ease-in-out infinite;
}

/* Keep UI above the glow */
.topbar, .sidebar, .page{ position: relative; z-index: 1; }

/* Route container for better mobile handling */
.route-container {
  width: 100%;
  min-height: 100%;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  user-select: none;
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .route-container {
    padding-bottom: 60px; /* Space for bottom nav if needed */
  }

  /* Improve touch targets */
  a, button, [role="button"] {
    min-height: 44px;
    min-width: 44px;
    padding: 12px;
    touch-action: manipulation;
  }

  /* Remove hover states on touch devices */
  @media (hover: none) {
    a:hover, button:hover {
      background-color: inherit !important;
    }
  }
}

/* Larger drift so it's obvious */
@keyframes glow-drift{
  0%   { background-position: 12% 10%, 84% 90%; }
  50%  { background-position: 26% 18%, 74% 82%; }
  100% { background-position: 10% 24%, 88% 76%; }
}

/* Breathe the blob sizes */
@keyframes glow-size{
  0%   { background-size: 38vw 38vw, 44vw 44vw; }
  50%  { background-size: 52vw 52vw, 58vw 58vw; }
  100% { background-size: 46vw 46vw, 50vw 50vw; }
}

/* Soft opacity pulse */
@keyframes glow-pulse{
  0%,100% { opacity: .85; filter: saturate(1); }
  50%     { opacity: 1;    filter: saturate(1.08); }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .app-shell::before{ animation: none; }
}

/* --------------------------------------------
   4) TOP BAR
   -------------------------------------------- */
.topbar{
  position: sticky; top:0; z-index:50;
  height: var(--topbar-h);
  display:flex; align-items:center; gap:12px;
  padding: 0 var(--space-3);
  background: var(--topbar-bg);
  border-bottom: 1px solid var(--border-color);
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}
.brand{
  font-size:1.05rem;
  font-weight:650;
  color: var(--brand);
  margin:0;
}

/* Icon button (vite logo trigger) */
.icon-btn{
  background: transparent;
  border:0;
  color: var(--text-color);
  width:40px; height:40px;
  display:grid; place-items:center;
  border-radius:10px;
  cursor:pointer;
  outline:none;
}
.icon-btn:hover{ background: color-mix(in oklab, var(--text-color) 6%, transparent) }
.icon-btn:focus-visible{ box-shadow:0 0 0 3px var(--ring) }
.logo-toggle{ transition: transform .22s ease }
.logo-toggle.is-open{ transform: rotate(180deg) scale(1.02) }

/* --------------------------------------------
   5) PAGE LAYOUT — Improved spacing
   -------------------------------------------- */

/* Base page: with proper spacing from top */
.page {
  padding: calc(var(--topbar-h) + 32px) var(--space-4) var(--space-4);
  min-height: calc(100vh - var(--topbar-h));
  width: 100%; /* ensure full width on mobile */
  overflow-x: visible; /* allow content to flow normally */
  -webkit-overflow-scrolling: touch; /* smooth scroll on iOS */
  position: relative;
  z-index: 2; /* ensure proper stacking order */
  touch-action: manipulation; /* optimize touch behavior */
  max-width: 1200px; /* prevent overly wide content */
  margin: 0 auto; /* center content */
}

/* Content wrapper to provide consistent spacing */
.page > *:first-child {
  margin-top: 0;
  padding-top: 0; /* Remove extra padding since we handle it in .page */
}

/* Container styles for better content organization */
.container {
  width: 100%;
  max-width: 980px;
  margin: 0 auto;
  padding: 0 var(--space-3);
}

/* Mobile address bar safe height */
@supports (height: 100svh){
  .page{ min-height: calc(100svh - var(--topbar-h)); }
}

/* If a page previously used .page-top, keep it flush too */
.page.page-top{
  min-height: auto;
  overflow: visible;
}

/* Ensure container pages have proper spacing */
.page > .container {
  padding-top: var(--space-4);
}

/* First element can’t reintroduce a top gap */
.page > *:first-child,
.page.page-top > *:first-child{
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* Keep content width constraints tidy when using .container */
.page > .container,
.page.page-top > .container{
  margin-inline: auto;
  max-width: 980px;
}

/* Home route with improved spacing */
.home-route {
  padding: calc(var(--topbar-h) + 48px) var(--space-4) var(--space-4);
  min-height: calc(100vh - var(--topbar-h));
  max-width: 1400px; /* slightly wider for home content */
  margin: 0 auto;
}
@supports (height: 100svh){
  .home-route{ min-height: calc(100svh - var(--topbar-h)); }
}

/* Desktop: push content only when the sidebar is actually open */
@media (min-width: 1024px){
  .page.has-sidebar{ margin-left: var(--sidebar-w); }
}

/* --------------------------------------------
   6) HOME LANDING (centered hero)
   -------------------------------------------- */
.home{
  height: 100%;               /* fill the whole main area */
  display: grid;
  /* align near the top under the topbar, keep horizontal centering */
  place-items: start center;
  text-align: center;
  /* ensure no extra top padding so the hero sits directly under the topbar */
  padding-top: 0;
  padding-left: var(--space-3);
  padding-right: var(--space-3);
  padding-bottom: var(--space-4);
}
.home-content{
  max-width: 700px;
  margin: -8px auto 0; /* negative margin to pull content up */
  animation: fadeIn .8s ease;
  padding: 0 !important;
}
.home-content > *:first-child { margin-top: 0 !important; padding-top: 0 !important; }
.home-content > *:last-child{ margin-bottom: 0 }
.home-title{
  font-size: clamp(1.8rem, 1rem + 3vw, 2.8rem);
  font-weight: 800;
  margin-bottom: var(--space-2);
}
.home-title span{ color: var(--brand) }
.home-subtitle{
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--brand-2);
  margin-bottom: var(--space-2);
}
.home-text{ margin-bottom: var(--space-4) }
.home-actions{ display:flex; justify-content:center; gap:16px; flex-wrap:wrap }
.home-logo{
  width: clamp(56px, 9vw, 84px);
  height: auto;
  margin-bottom: var(--space-3);
  filter: 
    drop-shadow(0 0 15px color-mix(in oklab, var(--brand) 45%, transparent))
    drop-shadow(0 -8px 25px color-mix(in oklab, var(--primary) 35%, transparent));
  animation: logoGlow 3s ease-in-out infinite alternate;
}

@keyframes logoGlow {
  from { 
    filter: 
      drop-shadow(0 0 15px color-mix(in oklab, var(--brand) 45%, transparent))
      drop-shadow(0 -8px 25px color-mix(in oklab, var(--primary) 35%, transparent));
  }
  to { 
    filter: 
      drop-shadow(0 0 20px color-mix(in oklab, var(--brand) 55%, transparent))
      drop-shadow(0 -10px 30px color-mix(in oklab, var(--primary) 45%, transparent));
  }
}

/* --------------------------------------------
   7) TYPE
   -------------------------------------------- */
h1,h2,h3{ margin:0 0 var(--space-2) }
h2{ font-size:1.4rem; letter-spacing:.2px }
p{ margin:.35rem 0 1rem; color: var(--text-color) }
.muted{ color: var(--muted) }

/* --------------------------------------------
   8) BUTTONS (purple glow)
   -------------------------------------------- */
.btn{
  --p: var(--space-2) var(--space-3);
  display:inline-flex; align-items:center; gap:8px;
  padding: var(--p);
  border-radius: var(--radius);
  border:1px solid var(--border-color);
  text-decoration:none;
  color: var(--text-color);
  font-weight:600;
  cursor:pointer;
  background: var(--btn-panel);
  transition: transform .06s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.btn:hover{ background: var(--btn-panel-hover) }
.btn:active{ transform: translateY(1px) }
.btn:focus-visible{ outline:none; box-shadow:0 0 0 3px var(--ring) }

/* Primary + glow */
.btn-primary{
  position: relative;
  background: var(--btn-primary-bg);
  border-color: var(--btn-primary-border);
  color:#fff;
  box-shadow:
    0 8px 22px var(--glow-soft),
    inset 0 0 0 1px rgba(255,255,255,.06);
}
.btn-primary:hover{
  background: var(--btn-primary-bg-hover);
  border-color: var(--btn-primary-border-hover);
  box-shadow:
    0 10px 28px var(--glow-main),
    0 0 0 2px rgba(124,92,255,.15),
    inset 0 0 0 1px rgba(255,255,255,.08);
  filter: brightness(1.04);
}
.btn-primary:focus-visible{
  box-shadow:
    0 10px 28px var(--glow-main),
    0 0 0 3px var(--ring),
    inset 0 0 0 1px rgba(255,255,255,.1);
}

/* Ghost + optional glow */
.btn-ghost{ background: transparent }
.btn-ghost.glow{
  border-color: color-mix(in oklab, var(--primary) 55%, transparent);
  box-shadow: 0 6px 18px var(--glow-soft);
}
.btn-ghost.glow:hover{
  box-shadow: 0 10px 26px var(--glow-main);
  background: color-mix(in oklab, var(--primary) 10%, transparent);
}

/* Button rows */
.actions{ display:flex; flex-wrap:wrap; gap:12px; margin-top: var(--space-3) }

/* --------------------------------------------
   9) FORMS
   -------------------------------------------- */
input,textarea{
  padding:10px 12px;
  border-radius:10px;
  border:1px solid var(--border-color);
  background: var(--input-bg);
  color: var(--text-color);
}
label>span{ color: var(--muted); font-size:.95rem }

/* --------------------------------------------
   10) QUIZ OPTIONS
   -------------------------------------------- */
.options{ 
  display: grid; 
  gap: 10px;
  width: 100%;
  max-width: 100%;
  margin-top: var(--space-2);
  margin-bottom: var(--space-3);
}
.option{
  text-align: left;
  border: 1px solid var(--border-color);
  background: var(--panel);
  color: var(--text-color);
  border-radius: 12px;
  padding: 1rem 1.2rem;
  cursor: pointer;
  width: 100%;
  transition: border-color .15s ease, background .15s ease, transform .12s ease, box-shadow .15s ease;
}
.option:hover{
  background: color-mix(in oklab, var(--text-color) 6%, transparent);
  border-color: color-mix(in oklab, var(--text-color) 18%, transparent);
  transform: translateY(-1px);
}
.option:focus-visible{ outline:none; box-shadow:0 0 0 3px var(--ring) }
.option:active{ transform: translateY(0) }
.option[disabled]{ opacity:.6; cursor:not-allowed; transform:none }

.quiz-head{ 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  margin: 0 0 var(--space-4);
  width: 100%;
  padding-top: var(--space-4);
}
.progress{ 
  color: var(--muted);
  font-weight: 600;
}
.q{ 
  margin: var(--space-3) 0;
  font-size: 1.1rem;
  line-height: 1.5;
}

/* --------------------------------------------
   11) UTILITIES
   -------------------------------------------- */
.text-center{ text-align:center }
.mt-1{ margin-top: var(--space-1) }
.mt-2{ margin-top: var(--space-2) }
.mt-3{ margin-top: var(--space-3) }
.mt-4{ margin-top: var(--space-4) }
.mb-0{ margin-bottom:0 }

/* --------------------------------------------
   12) ACCESSIBILITY & MOTION
   -------------------------------------------- */
@media (prefers-reduced-motion: reduce){
  .logo-toggle, .option, .btn{ transition: none }
}
@media (forced-colors: active){
  .btn:focus-visible, .option:focus-visible{ outline: 2px solid Highlight; box-shadow: none }
}

/* --------------------------------------------
   13) KEYFRAMES
   -------------------------------------------- */
@keyframes fadeIn{
  from { opacity:0; transform: translateY(15px) }
  to   { opacity:1; transform: translateY(0) }
}
/* --------------------------------------------
   15) MOBILE BREAKPOINT TUNING (≤640px)
   -------------------------------------------- */
@media (max-width: 640px){
  /* Optimize mobile layout and touch interactions */
  .page{ 
    padding: 0 var(--space-2) var(--space-3);
    touch-action: manipulation; /* optimize touch handling */
  }
  .page.page-top{ padding-top: 0; }

  /* Ensure content fits mobile screens */
  .page > .container,
  .page.page-top > .container{
    max-width: 100%;
    padding-inline: var(--space-2);
    width: 100%;
    overflow-x: hidden;
  }
  
  /* Add safe area insets for modern mobile browsers */
  @supports(padding: max(0px)) {
    .page {
      padding-left: max(var(--space-2), env(safe-area-inset-left));
      padding-right: max(var(--space-2), env(safe-area-inset-right));
      padding-bottom: max(var(--space-3), env(safe-area-inset-bottom));
    }
  }

  /* headline & hero bits */
  .home-title{
    /* slightly smaller top headings on phones */
    font-size: clamp(1.6rem, 5.5vw, 2.2rem);
    line-height: 1.15;
  }
  .home-subtitle{ font-size: 1.05rem; }
  .home-logo{ width: clamp(48px, 12vw, 72px); }

  /* action row: buttons stack nicely */
  .home-actions{
    flex-direction: column;
    gap: 10px;
  }
  .home-actions .btn{ width: 100%; } /* big, tappable targets */

  /* global button targets on small screens */
  .btn{ padding: 12px 14px; }

  /* lists & paragraphs tighten a bit */
  p{ margin: .25rem 0 .85rem; }
  .about-list{ padding-left: 1.15rem; }

  /* quiz: larger touch targets + readable spacing */
  .options{ gap: 12px; }
  .option{
    padding: 14px 14px;
    font-size: 0.98rem;
  }
  .quiz-head{
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
  }

  /* animated background glow: smaller & gentler on phones */
  .app-shell::before{
    background-size: 70vw 70vw, 80vw 80vw;
    animation-duration: 22s, 2000s, 8s; /* slower drift/pulse */
    opacity: .9;
  }
}

/* --------------------------------------------
   16) SMALL TABLET TUNING (641–900px)
   -------------------------------------------- */
@media (min-width: 641px) and (max-width: 900px){
  .page{ padding: var(--space-4) var(--space-3); }
  .home-title{ font-size: clamp(1.8rem, 3.5vw, 2.6rem); }
  .home-actions{ gap: 12px; }
}
